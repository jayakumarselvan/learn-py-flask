INFO:app:sql_get_rates
INFO:app:
    select
      to_char(gs_tbl.gs_day, 'YYYY-MM-DD') as "day",
      result_tbl.average_price
    from
      (
        select generate_series.gs_day::date 
        from generate_series(%s::date, %s::date, interval '1 day') as generate_series(gs_day)
      ) as gs_tbl
      left join (
        select 
          pr."day",
          (
            case 
              when COUNT(1) >=%s then CAST(ROUND(AVG(pr.price))AS INTEGER)
                    else null
              end
          ) as average_price
        from 
          prices as pr
          left join ports as p_oc on p_oc.code = pr.orig_code
          left join ports as p_dc on p_dc.code = pr.dest_code
          left join regions as r_p_oc on r_p_oc.slug = p_oc.parent_slug
          left join regions as r_p_dc on r_p_dc.slug = p_dc.parent_slug
        where
          ( pr.day between %s and %s )
          and ( pr.orig_code =%s or p_oc.parent_slug = %s or r_p_oc.parent_slug = %s )
          and ( pr.dest_code =%s or p_dc.parent_slug = %s or r_p_dc.parent_slug = %s )
        group by pr.day
      ) as result_tbl on result_tbl.day = gs_tbl.gs_day
      order by gs_tbl.gs_day
       limit  10 offset 0 
    
INFO:app:where_values
INFO:app:('2016-01-01', '2016-01-10', 3, '2016-01-01', '2016-01-10', 'CNSGH', 'CNSGH', 'CNSGH', 'north_europe_main', 'north_europe_main', 'north_europe_main')
INFO:werkzeug:127.0.0.1 - - [01/Apr/2023 15:57:28] "GET /api/v1/rates?date_from=2016-01-01&date_to=2016-01-10&origin=CNSGH&destination=north_europe_main&page=1&limit=10 HTTP/1.1" 200 -
INFO:app:sql_get_rates
INFO:app:
    select
      to_char(gs_tbl.gs_day, 'YYYY-MM-DD') as "day",
      result_tbl.average_price
    from
      (
        select generate_series.gs_day::date 
        from generate_series('2016-01-01'::date, '2016-01-10'::date, interval '1 day') as generate_series(gs_day)
      ) as gs_tbl
      left join (
        select 
          pr."day",
          (
            case 
              when COUNT(1) >=3 then CAST(ROUND(AVG(pr.price))AS INTEGER)
                    else null
              end
          ) as average_price
        from 
          prices as pr
          
      left join ports as p_oc on p_oc.code = pr.orig_code
      left join ports as p_dc on p_dc.code = pr.dest_code
      left join regions as r_p_oc on r_p_oc.slug = p_oc.parent_slug
      left join regions as r_p_dc on r_p_dc.slug = p_dc.parent_slug
    
        where
          ( pr.day between '2016-01-01' and '2016-01-10' )
          
      and ( pr.orig_code = 'CNSGH' or p_oc.parent_slug = 'CNSGH' or r_p_oc.parent_slug = 'CNSGH' )
      and ( pr.dest_code = 'north_europe_main' or p_dc.parent_slug = 'north_europe_main' or r_p_dc.parent_slug = 'north_europe_main' )
    
        group by pr.day
      ) as result_tbl on result_tbl.day = gs_tbl.gs_day
      order by gs_tbl.gs_day
       limit  10 offset 0 
    
INFO:werkzeug:127.0.0.1 - - [01/Apr/2023 15:57:32] "GET /api/v1/rates-list?date_from=2016-01-01&date_to=2016-01-10&origin=CNSGH&destination=north_europe_main&page=1&limit=10 HTTP/1.1" 200 -
INFO:app:sql_get_rates
INFO:app:
    select
      to_char(gs_tbl.gs_day, 'YYYY-MM-DD') as "day",
      result_tbl.average_price
    from
      (
        select generate_series.gs_day::date 
        from generate_series('2016-01-01'::date, '2016-01-10'::date, interval '1 day') as generate_series(gs_day)
      ) as gs_tbl
      left join (
        select 
          pr."day",
          (
            case 
              when COUNT(1) >=3 then CAST(ROUND(AVG(pr.price))AS INTEGER)
                    else null
              end
          ) as average_price
        from 
          prices as pr
          
        where
          ( pr.day between '2016-01-01' and '2016-01-10' )
          
      and ( pr.orig_code = 'CNSGH' )
      and ( pr.dest_code = 'EETLL' )
    
        group by pr.day
      ) as result_tbl on result_tbl.day = gs_tbl.gs_day
      order by gs_tbl.gs_day
       limit  10 offset 0 
    
INFO:werkzeug:127.0.0.1 - - [01/Apr/2023 15:57:41] "GET /api/v1/rates-list?date_from=2016-01-01&date_to=2016-01-10&origin=CNSGH&destination=EETLL&page=1&limit=10 HTTP/1.1" 200 -